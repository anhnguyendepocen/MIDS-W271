---
title: "MIDS W271-4 Homework 7"
author: "Subhashini R., Lei Yang, Ron Cordell"
date: "March 22, 2016"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Question 1:

**1.1 Load hw07_series1.csv**

```{r}
df <- read.csv('hw07_series1.csv')
```

**1.2 Describe the basic structure of the data and provide summary statistics of the series**

```{r}
# take a look at the data structure
str(df)

# take a look at the first part of the data
head(df,5)

# get a summary of the data
summary(df)
```

The data consists of 74 observations of a single variable, X10.01. There is no information on the sampling rate or if the samples fit into an overall time structure such as years, quarters, months or something else (frequency). Therefore we will create a time series object from it without imposing those parameters.

```{r}
ts1 <- ts(df, start=1, end=74, frequency=1)
```

**1.3 Plot histogram and time-series plot of the series. Describe the patterns exhibited in histograrm and time-series plot. For time series analysis, is it sufficient to use only histogram to describe a series?**

```{r}
hist(ts1, main='Histogram of Time Series', xlab='X10.01', breaks=20)
plot.ts(ts1, col='blue', 
        xlab='Time',
        ylab='X10.01')
```

**1.4 Plot the ACF and PACF of the series. Describe the patterns exhibited in the ACF and PACF.**

```{r}
acf(ts1, xlab='Lag')
pacf(ts1, xlab='Lag')
```

**1.5 Estimate the series using the ar() function.**

``` {r}
ts1.ar <- ar(ts1)
```

**1.6 Report the estimated AR parameters, the order of the model, and standard errors.**

```{r}
# AR model summary
summary(ts1.ar)

# AR model order
ts1.ar$order

# AR model coefficients
ts1.ar$asy.var.coef
```


## Question 2:

**2.1 Simulate a time series of length 100 for the following model. Name the series x.**
$$x_{t} = \frac{5}{6}x_{t-1} - \frac{1}{6}x_{t-2} + \omega_{t}$$

```{r}
set.seed(1)
x <- x1 <- w <- rnorm(100)

# create lagged variable x
for (i in 3:100) x[i] <- (5/6)* x1[i-1] + (1/6)*x1[i-2] + w[i]
```

**2.2 Plot the correlogram and partial correlogram for the simulated series. Comments on the plots.**

```{r}
acf(x, main='Correlogram of X', xlab='Lag')
pacf(x, main='Partial Correlogram of X', xlab='Lag')
```

**2.3 Estimate an AR model for this simulated series. Report the estimated AR parameters, standard errors, and the order of the AR model.**

```{r}
# fit an AR model to the X series
x.ar <- ar(x)

# show a summary of the model
summary(x.ar)

# show the model order
x.ar$order

# show the model coefficients
x.ar$asy.var.coef


```


**2.4 Construct a 95% confidence intervals for the parameter estimates of the estimated model. Do the “true” mode parameters fall within the confidence intervals? Explain the 95% confidence intervals in this context.**

**2.5 Is the estimated model stationary or non-stationary?**

**2.6 Plot the correlogram of the residuals of the estimated model. Comment on the plot.**

```{r}
acf(x.ar$resid, na.action=na.omit, main='AR Model Residuals Correlogram')
```

